<h2>{{ _('Subpages') }}</h2>

{% set primary = record.alt == '_primary' %}

<form id="subpages-form" action="." method="POST">
  {% if subpages %}
  <input type="hidden" name="form_id" value="subpages-form"/>
  <div class="field content-listing">
    <table>
      <thead>
        <tr>
          {% if primary %}
          <th>{{ _('Select') }}</th>
          {% endif %}
          <th>{{ _('Name') }}</th>
          <th>{{ _('Title') }}</th>
          <th>{{ _('Type') }}</th>
        </tr>
      </thead>
      <tbody>
        {% for subpage in subpages %}
        <tr>
          {% if primary %}
          <td>
            <input type="checkbox" name="selected-items" value="{{ subpage.path }}"/>
          </td>
          {% endif %}
          <td>
            {% set alt_param = record.alt if record.alt != '_primary' else None %}
            <a href="{{ url_for('tekir_admin.contents', path=subpage.path, alt=alt_param) }}">{{ subpage._slug }}</a>
          </td>
          <td>
            {{ subpage.title }}
          </td>
          <td>
            {{ subpage.datamodel.name_i18n.get(g.lang_code, subpage.datamodel.name) }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

    {% if primary %}
  <button
      hx-post="{{ url_for('tekir_admin.api.delete_confirm') }}"
      hx-target="#delete-dialog">
    {% include 'icons/delete.svg' %} <span>{{ _('Delete selected') }}</span>
  </button>
    {% endif %}
  {% else %}
  <div class="field content-listing">
    <p>{{ _('No subpages.') }}</p>
  </div>
  {% endif %}

  {% if primary %}
  <button
      hx-get="{{ url_for('tekir_admin.api.new_subpage', path=record.path) }}"
      hx-target="#new-subpage-dialog">
    {% include 'icons/document-new.svg' %} <span>{{ _('Add') }}</span>
  </button>
  {% endif %}
</form>
